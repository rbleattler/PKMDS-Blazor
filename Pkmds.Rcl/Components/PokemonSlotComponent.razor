@inherits BasePkmdsComponent

<MudPaper Elevation="3"
          @onclick="@HandleClick"
          draggable="@IsDraggable()"
          @ondragstart="@HandleDragStart"
          @ondragend="@HandleDragEnd"
          @ondragenter="@HandleDragEnter"
          @ondragover="@HandleDragOver"
          @ondragleave="@HandleDragLeave"
          @ondrop="@HandleDrop"
          Class="@($"square-slot {GetClass()} {GetDragClass()} {ImageHelper.GetSpriteCssClass(Pokemon)}")">
    <div
        class="w-full h-full aspect-square flex items-center justify-center overflow-hidden p-0 box-border border border-transparent relative">
        @if (Pokemon is not null && Pokemon.Species > 0)
        {
            var title = GetPokemonTitle();
            <object class="pkm-sprite w-full h-auto object-contain block"
                    type="image/png"
                    data="@(Pokemon is { Species: > 0 }
                              ? ImageHelper.GetPokemonSpriteFilename(Pokemon)
                              : null)"
                    title="@title">
                <img class="pkm-sprite w-full h-auto object-contain block"
                     src="@ImageHelper.PokemonFallbackImageFileName"
                     title="@title"
                     alt="@title">
            </object>
            @if (Pokemon.GetIsShinySafe())
            {
                <div class="shiny-indicator-icon"
                     title="Shiny">
                    <img src="@ImageHelper.GetShinyIndicatorSpriteFileName(ShinyExtensions.GetType(Pokemon) is Shiny shiny && shiny is Shiny.AlwaysSquare)"
                         alt="Shiny"
                         class="w-full h-full object-contain">
                </div>
            }

            @if (GetLegalityValid() is { } isLegal)
            {
                <div class="legality-indicator-icon"
                     title="@(isLegal
                                ? "Legal"
                                : "Illegal")">
                    <img src="@(isLegal
                                  ? ImageHelper.GetLegalityValidSpriteFileName()
                                  : ImageHelper.GetLegalityWarnSpriteFileName())"
                         alt="@(isLegal
                                  ? "Legal"
                                  : "Illegal")"
                         class="w-full h-full object-contain">
                </div>
            }

            @if (IsAlphaPokemon())
            {
                <div class="alpha-indicator-icon"
                     title="Alpha">
                    <img src="@ImageHelper.GetAlphaIndicatorSpriteFileName()"
                         alt="Alpha"
                         class="w-full h-full object-contain">
                </div>
            }

            @if (GetLetsGoPartySlotNumber() is { } partySlot)
            {
                <div class="party-slot-indicator-icon"
                     title="@($"Party Slot {partySlot}")">
                    <img src="@ImageHelper.GetPartySlotIndicatorSpriteFileName(partySlot)"
                         alt="@($"Party {partySlot}")"
                         class="w-full h-full object-contain">
                </div>
            }

            @if (Pokemon.HeldItem != 0)
            {
                var itemTitle = GetItemTitle();
                <div class="held-item-icon">
                    <object type="image/png"
                            data="@ImageHelper.GetItemSpriteFilename(Pokemon.HeldItem, Pokemon.Context)"
                            title="@itemTitle"
                            class="w-full h-full object-contain">
                        <img src="@ImageHelper.ItemFallbackImageFileName"
                             title="@itemTitle"
                             alt="@itemTitle"
                             class="w-full h-full object-contain">
                    </object>
                </div>
            }
        }
    </div>
</MudPaper>
